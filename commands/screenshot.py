import pyautogui
from aiogram import types
from aiogram.types import ReplyKeyboardMarkup, KeyboardButton


async def screenshot(message: types.Message, user_data: dict = None):
    if user_data is None:
        user_data = {}
    if message.text in ["üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é", "‚¨ÖÔ∏è –ù–∞–∑–∞–¥", "/cancel"]:
        try:
            from bot import MAIN_COMMAND_BUTTONS
            await message.answer("–í–æ–∑–≤—Ä–∞—Ç –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é.", reply_markup=ReplyKeyboardMarkup(keyboard=MAIN_COMMAND_BUTTONS, resize_keyboard=True))
        except Exception:
            await message.answer("–í–æ–∑–≤—Ä–∞—Ç –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é.")
        return 'CANCELLED'

    screenshot_img = pyautogui.screenshot()
    screenshot_img.save("screenshot.png")
    with open("screenshot.png", "rb") as photo:
        await message.answer_photo(photo)
    keyboard = ReplyKeyboardMarkup(keyboard=[[KeyboardButton("üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é"), KeyboardButton("‚¨ÖÔ∏è –ù–∞–∑–∞–¥")]], resize_keyboard=True)
    await message.answer("–°–∫—Ä–∏–Ω—à–æ—Ç —Å–¥–µ–ª–∞–Ω –∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤–∞–º!", reply_markup=keyboard)